<!DOCTYPE HTML>
<html lang="en" >
    
    <head>
        
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <title>FailMode | rpcx Programming</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 2.6.7">
        <meta name="author" content="smallnest &lt;smallnest@gmail.com&gt;">
        
        <meta name="HandheldFriendly" content="true"/>
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
        <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">
        
    <link rel="stylesheet" href="../gitbook/style.css">
    
        
        <link rel="stylesheet" href="../gitbook/plugins/gitbook-plugin-anchors/plugin.css">
        
    
        
        <link rel="stylesheet" href="../gitbook/plugins/gitbook-plugin-multipart/multipart.css">
        
    
        
        <link rel="stylesheet" href="../gitbook/plugins/gitbook-plugin-page-footer-ex/style/plugin.css">
        
    
        
        <link rel="stylesheet" href="../gitbook/plugins/gitbook-plugin-timeline/timeline.css">
        
    
        
        <link rel="stylesheet" href="../gitbook/plugins/gitbook-plugin-katex/katex.min.css">
        
    
        
        <link rel="stylesheet" href="../gitbook/plugins/gitbook-plugin-disqus/plugin.css">
        
    
        
        <link rel="stylesheet" href="../gitbook/plugins/gitbook-plugin-highlight/website.css">
        
    
        
        <link rel="stylesheet" href="../gitbook/plugins/gitbook-plugin-search/search.css">
        
    
        
        <link rel="stylesheet" href="../gitbook/plugins/gitbook-plugin-fontsettings/website.css">
        
    
    

        
    
    
    <link rel="next" href="../part3/fork.html" />
    
    
    <link rel="prev" href="../part3/codec.html" />
    

        
    </head>
    <body>
        
        
    <div class="book"
        data-level="6"
        data-chapter-title="FailMode"
        data-filepath="part3/failmode.md"
        data-basepath=".."
        data-revision="Mon Feb 12 2018 15:34:29 GMT+0800 (CST)"
        data-innerlanguage="">
    

<div class="book-summary">
    <nav role="navigation">
        <ul class="summary">
            
            
            
                
                <li>
                    <a href="http://rpcx.site/" target="blank" class="custom-link">rpcx官方站点</a>
                </li>
            
            

            
            <li class="divider"></li>
            

            
    
        <li class="chapter " data-level="0" data-path="index.html">
            
                
                    <a href="../index.html">
                
                        <i class="fa fa-check"></i>
                        
                        Introduction
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1" data-path="part1/quickstart.html">
            
                
                    <a href="../part1/quickstart.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.</b>
                        
                        QuickStart
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2" data-path="part1/server.html">
            
                
                    <a href="../part1/server.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.</b>
                        
                        Server
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3" data-path="part1/client.html">
            
                
                    <a href="../part1/client.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.</b>
                        
                        Client
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4" data-path="part2/registry.html">
            
                
                    <a href="../part2/registry.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.</b>
                        
                        Registry
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.1" data-path="part2/registry.html">
            
            <span><b>4.1.</b> Peer to Peer</span>
            
            
        </li>
    
        <li class="chapter " data-level="4.2" data-path="part2/registry.html">
            
            <span><b>4.2.</b> Peer to Multiple</span>
            
            
        </li>
    
        <li class="chapter " data-level="4.3" data-path="part2/registry.html">
            
            <span><b>4.3.</b> Zookeeper</span>
            
            
        </li>
    
        <li class="chapter " data-level="4.4" data-path="part2/registry.html">
            
            <span><b>4.4.</b> Etcd</span>
            
            
        </li>
    
        <li class="chapter " data-level="4.5" data-path="part2/registry.html">
            
            <span><b>4.5.</b> Consul</span>
            
            
        </li>
    
        <li class="chapter " data-level="4.6" data-path="part2/registry.html">
            
            <span><b>4.6.</b> mDNS</span>
            
            
        </li>
    
        <li class="chapter " data-level="4.7" data-path="part2/registry.html">
            
            <span><b>4.7.</b> In process</span>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="5" data-path="part3/codec.html">
            
                
                    <a href="../part3/codec.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.</b>
                        
                        Codec
                    </a>
            
            
        </li>
    
        <li class="chapter active" data-level="6" data-path="part3/failmode.html">
            
                
                    <a href="../part3/failmode.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>6.</b>
                        
                        FailMode
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="6.1" data-path="part3/failmode.html">
            
            <span><b>6.1.</b> Failfast</span>
            
            
        </li>
    
        <li class="chapter " data-level="6.2" data-path="part3/failmode.html">
            
            <span><b>6.2.</b> Failover</span>
            
            
        </li>
    
        <li class="chapter " data-level="6.3" data-path="part3/failmode.html">
            
            <span><b>6.3.</b> Failtry</span>
            
            
        </li>
    
        <li class="chapter " data-level="6.4" data-path="part3/failmode.html">
            
            <span><b>6.4.</b> Failbackup</span>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="7" data-path="part3/fork.html">
            
                
                    <a href="../part3/fork.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>7.</b>
                        
                        Fork
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="8" data-path="part3/broadcast.html">
            
                
                    <a href="../part3/broadcast.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>8.</b>
                        
                        Broadcase
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="9" data-path="part3/selector.html">
            
                
                    <a href="../part3/selector.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>9.</b>
                        
                        Selector
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="9.1" data-path="part3/selector.html">
            
            <span><b>9.1.</b> Random</span>
            
            
        </li>
    
        <li class="chapter " data-level="9.2" data-path="part3/selector.html">
            
            <span><b>9.2.</b> Roundrobin</span>
            
            
        </li>
    
        <li class="chapter " data-level="9.3" data-path="part3/selector.html">
            
            <span><b>9.3.</b> Consistent hashing</span>
            
            
        </li>
    
        <li class="chapter " data-level="9.4" data-path="part3/selector.html">
            
            <span><b>9.4.</b> Weighted</span>
            
            
        </li>
    
        <li class="chapter " data-level="9.5" data-path="part3/selector.html">
            
            <span><b>9.5.</b> Network quality</span>
            
            
        </li>
    
        <li class="chapter " data-level="9.6" data-path="part3/selector.html">
            
            <span><b>9.6.</b> Geography</span>
            
            
        </li>
    
        <li class="chapter " data-level="9.7" data-path="part3/selector.html">
            
            <span><b>9.7.</b> Customized Selector</span>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="10" data-path="part4/metrics.html">
            
                
                    <a href="../part4/metrics.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>10.</b>
                        
                        Metrics
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="11" data-path="part4/rate-limiting.html">
            
                
                    <a href="../part4/rate-limiting.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>11.</b>
                        
                        Rate Limiting
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="12" data-path="part4/alias.html">
            
                
                    <a href="../part4/alias.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>12.</b>
                        
                        Alias
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="13" data-path="part4/auth.html">
            
                
                    <a href="../part4/auth.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>13.</b>
                        
                        Auth
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="14" data-path="part4/plugin-dev.html">
            
                
                    <a href="../part4/plugin-dev.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>14.</b>
                        
                        Plugin Development
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="15" data-path="part5/benchmark.html">
            
                
                    <a href="../part5/benchmark.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>15.</b>
                        
                        Benchmark
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="16" data-path="part5/ui.html">
            
                
                    <a href="../part5/ui.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>16.</b>
                        
                        UI Manager
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="17" data-path="part5/protocol.html">
            
                
                    <a href="../part5/protocol.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>17.</b>
                        
                        protocol
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="18" data-path="part6/gateway.html">
            
                
                    <a href="../part6/gateway.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>18.</b>
                        
                        Gateway
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="19" data-path="part6/http_invoke.html">
            
                
                    <a href="../part6/http_invoke.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>19.</b>
                        
                        HTTP Invoke
                    </a>
            
            
        </li>
    


            
            <li class="divider"></li>
            <li>
                <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
                    Published with GitBook
                </a>
            </li>
            
        </ul>
    </nav>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="book-header" role="navigation">
    <!-- Actions Left -->
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../" >rpcx Programming</a>
    </h1>
</div>

            <div class="page-wrapper" tabindex="-1" role="main">
                <div class="page-inner">
                
                
                    <section class="normal" id="section-">
                    
                        <h1 id="failmode">FailMode</h1>
<p>In the distribution architecture such SOA or micro service, you can not guarantee services always work well. Maybe  the server is down or network is slow or broken. So you need to handle invocation failures.</p>
<p>rpcx has three fail modes to handle invocation failures and you can set it when create XClient.</p>
<p>FailMode is meaningful only for sync call (<code>XClient.Call</code>).</p>
<h2 id="failfast">Failfast </h2>
<p><strong>Example:</strong> <a href="https://github.com/rpcx-ecosystem/rpcx-examples3/tree/master/failmode/failfast" target="_blank">failfast</a></p>
<p>In this mode, rpcx will finished this call if it gets a failure. The failure is not business failure and business failures are normal responses. It may be caused by server crashing or network issues.</p>
<h2 id="failover">Failover </h2>
<p><strong>Example:</strong> <a href="https://github.com/rpcx-ecosystem/rpcx-examples3/tree/master/failmode/failover" target="_blank">failover</a></p>
<p>In this mode, rpcx will try another nodes if it gets a failure. it will try <code>retries</code> until the service returns normal response. The <code>retries</code> is defined in <code>Option</code> and it is <code>3</code> in the defaultOption.</p>
<h2 id="failtry">Failtry </h2>
<p><strong>Example:</strong> <a href="https://github.com/rpcx-ecosystem/rpcx-examples3/tree/master/failmode/failtry" target="_blank">failtry</a></p>
<p>In this mode, rpcx still try current selected nodes if it gets a failure. it will try <code>retries</code> until the service returns normal response. The <code>retries</code> is defined in <code>Option</code> and it is <code>3</code> in the defaultOption.</p>
<h2 id="failbackup">Failbackup </h2>
<p><strong>Example:</strong> <a href="https://github.com/rpcx-ecosystem/rpcx-examples3/tree/master/failmode/failbackup" target="_blank">failbackup</a></p>
<p>In this mode, rpcx will send another request to one of servers if the first request has not returned in a given time. rpcx uses the the fastest returned response of the two requests. The given time is configured in <code>Option.BackupLatency</code>.</p>
<p>If ypu want to learn more details about backup request pattern, you can read Jeff Dean&apos;s <a href="https://static.googleusercontent.com/media/research.google.com/zh-CN//pubs/archive/44875.pdf" target="_blank">Achieving Rapid Response Times in Large Online Services</a></p>
<blockquote>
<p>From <a href="http://highscalability.com/blog/2012/6/18/google-on-latency-tolerant-systems-making-a-predictable-whol.html" target="_blank">http://highscalability.com/blog/2012/6/18/google-on-latency-tolerant-systems-making-a-predictable-whol.html</a>
Backup requests are the idea of sending requests out to multiple replicas, but in a particular way. Here&#x2019;s the example for a read operation for a distributed file system client:</p>
<p>send request to first replica
wait 2 ms, and send to second replica
servers cancel request on other replica when starting read
A request could wait in a queue stuck behind an expensive query or a packet could be dropped, so if a reply is not returned quickly other replicas are tried. Responses come back faster if requests sit in multiple queues.</p>
</blockquote>
<footer class="page-footer-ex"> <span class="page-footer-ex-copyright">By <em>smallnest</em></span>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class="page-footer-ex-footer-update"><i>updated</i>
2018-02-12 15:17:23
</span></footer>
                    
                    </section>
                
                
                </div>
            </div>
        </div>

        
        <a href="../part3/codec.html" class="navigation navigation-prev " aria-label="Previous page: Codec"><i class="fa fa-angle-left"></i></a>
        
        
        <a href="../part3/fork.html" class="navigation navigation-next " aria-label="Next page: Fork"><i class="fa fa-angle-right"></i></a>
        
    </div>
</div>

        
<script src="../gitbook/app.js"></script>

    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/URI.js/1.16.1/URI.min.js"></script>
    

    
    <script src="../gitbook/plugins/gitbook-plugin-disqus/plugin.js"></script>
    

    
    <script src="../gitbook/plugins/gitbook-plugin-search/lunr.min.js"></script>
    

    
    <script src="../gitbook/plugins/gitbook-plugin-search/search.js"></script>
    

    
    <script src="../gitbook/plugins/gitbook-plugin-sharing/buttons.js"></script>
    

    
    <script src="../gitbook/plugins/gitbook-plugin-fontsettings/buttons.js"></script>
    

<script>
require(["gitbook"], function(gitbook) {
    var config = {"theme-default":{"showLevel":true},"toc":{"addClass":true,"className":"toc"},"page-footer-ex":{"copyright":"By <em>smallnest</em>","markdown":false,"update_label":"<i>updated</i>","update_format":"YYYY-MM-DD HH:mm:ss"},"disqus":{"shortName":"rpcx-programming","useIdentifier":false},"anchors":{},"multipart":{},"timeline":{},"katex":{},"highlight":{},"search":{"maxIndexSize":1000000},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2}};
    gitbook.start(config);
});
</script>

        
    </body>
    
</html>
